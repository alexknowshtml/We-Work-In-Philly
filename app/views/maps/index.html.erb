<link href="http://www.google.com/uds/css/gsearch.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBJxinfMqFhdPjHPR5dSefcitYycTN526g&sensor=true&region=US"></script>
<script src="http://www.google.com/uds/api?file=uds.js&amp;v=1.0&amp;key=AIzaSyBJxinfMqFhdPjHPR5dSefcitYycTN526g" type="text/javascript"></script>
<script src="/javascripts/bradoyler.js" type="text/javascript"></script>
<script type="text/javascript">

function Location() {
  this.user_id = 1;
  this.name = "Unknown";
  this.location = "Unknown";
  this.website = "Unknown";
  this.category = "startup";
  this.Long = 40.05;
  this.Lat = -75.40;
}

function initialize() {

    var mapStyles = [
         { featureType: "road", elementType: "geometry", stylers: [{ hue: "#8800ff" }, { lightness: 100}] }, {
           featureType: "road", stylers: [{ visibility: "on" }, { hue: "#91ff00" }, { saturation: -62 }, { gamma: 1.98 }, { lightness: 45}]}, {
           featureType: "water", stylers: [{ hue: "#005eff" }, { gamma: 0.72 }, { lightness: 42}]}, { 
           featureType: "transit.line", stylers: [{ visibility: "on" }]}, {
           featureType: "administrative.locality", stylers: [ { visibility: "on" }]}, {
           featureType: "administrative.neighborhood", elementType: "geometry",stylers: [{ visibility: "simplified" }]}, {
           featureType: "landscape",stylers: [{ visibility: "on" },{ gamma: 0.41 },{ lightness: 46 }]}, {
           featureType: "administrative.neighborhood", elementType: "labels.text", stylers: [{ visibility: "on" }, { saturation: 33 }, { lightness: 20}]
         }
        ];

    var myLatlng = new google.maps.LatLng(40.05,-75.40);

    // Initialize the local searcher
    gLocalSearch = new GlocalSearch();
    gLocalSearch.setSearchCompleteCallback(null, OnLocalSearch);

    var myOptions = { zoom: 10, center: myLatlng, styles: mapStyles, mapTypeId: google.maps.MapTypeId.ROADMAP }
    gMap = new google.maps.Map(document.getElementById("map"), myOptions);

    $.getJSON("/mapfeed", function (data) {
        var locations = data;
        iw = new google.maps.InfoWindow();
        for (var i = 0; i < locations.length; i++) {
            var location = locations[i].company;
            addMarker(location);          
        }
    });
}
</script>

<h1>Companies</h1>

<p>
<a href="/companies/new">Add your company</a> to include it on this map!  
There are currently <%=@companies.length.to_s %> companies registered with valid street addresses.
</p>

<div id="map" style="width: 100%; height: 500px; border: 1px solid #979797;"></div>
